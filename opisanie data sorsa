1. Описание датасорса (Data Source)
Что такое датасорс

Датасорс — это подготовленный источник данных, который подключается к DataLens и используется для построения графиков и KPI.

В нашем случае датасорс называется:

dm_orders_source


Он построен на основе итоговой витрины с заказами.

Из каких файлов (таблиц) собран датасорс

Данные берутся из следующих CSV-файлов:

1. orders (olist_orders_dataset.csv)

Главная таблица заказов.
Из неё берём:

order_id — ID заказа

customer_id — ID клиента

order_purchase_timestamp — дата покупки

order_status — статус заказа

2. customers (olist_customers_dataset.csv)

Таблица с клиентами.
Из неё берём:

customer_id

customer_unique_id — уникальный пользователь

Важно:
именно отсюда берётся customer_unique_id для KPI «Уникальные клиенты».

3. order_items (olist_order_items_dataset.csv)

Таблица с товарами в заказе.
Из неё берём:

order_id

price — цена товара

freight_value — стоимость доставки

Именно здесь считается выручка.

Как формируется revenue (выручка)

В одном заказе может быть несколько товаров, поэтому строки повторяются.
Чтобы не было дублирования, выручка считается так:

revenue = SUM(price + freight_value) по каждому order_id


То есть:

сначала суммируем товары внутри заказа

потом получаем одну строку = один заказ

2. Описание витрины данных (DM)
Что такое витрина

Витрина (Data Mart) — это финальная таблица, подготовленная специально для аналитики и дашборда.

Она содержит уже очищенные и объединённые данные:

без дублей

с готовыми метриками

с нужными полями для KPI

Название витрины:

dm_orders

3. Структура витрины (поля)

В витрине используются следующие столбцы:

Поле	Описание
order_id	ID заказа
customer_unique_id	Уникальный клиент
order_date	Дата заказа
revenue	Выручка по заказу
order_status	Статус заказа
